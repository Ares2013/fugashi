#!/usr/bin/env python3

from fugashi import Tagger
import sys
import fileinput

def info(args=''):
    """Print configuration info."""
    tagger = Tagger(args)
    #TODO get the fugashi version here too
    print("Fugashi dictionary info:")
    print("-----")
    for di in tagger.dictionary_info:
        for field in 'version size charset filename'.split():
            print( (field + ':').ljust(10), di[field])
        print('-----')

def parse(args=''):
    """Parse input from stdin."""
    tagger = Tagger(args)

    for line in fileinput.input([]):
        print(tagger.parse(line.strip()))
    

if __name__ == '__main__':

    cmds = {
            'info': info,
            'parse': parse,
            }

    if len(sys.argv) < 2:
        print("Welcome to fugashi! Available commands: parse, info")
        sys.exit(1)

    try:
        cmd = sys.argv[1]
        args = sys.argv[2:]
        cmds[cmd](' '.join(args))
    except KeyError:
        print("Unknown command '{}'. Available commands: info, parse"
                .format(cmd))
        sys.exit(1)

        
